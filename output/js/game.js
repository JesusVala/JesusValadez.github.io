var ne=Object.defineProperty;var d=(o,n)=>ne(o,"name",{value:n,configurable:!0});var Y=new THREE.Color().setHex(8900331),ae=-100,re=-100,_=500,K=50*Math.PI/180,F=20*Math.PI/180,ie=10*Math.PI/180,Z=-Math.tan(K)*500,se=Math.tan(F)*Math.sqrt(500**2+Z**2),l=Object.freeze({DIR_LIGHT:{POSITION:{X:ae,Y:re},SHADOW:{CAMERA:{LEFT:-_,RIGHT:_,TOP:_,BOTTON:-_}}},CAMERA:{ROTATION:{X:K,Y:F,Z:ie},POSITION:{X:se,Y:Z}}}),h=15,E=42,m=17,u=E*m,G=["car","truck","forest"],B=[2,2.5,3];var U=[20,45,60];function j(){let o=new THREE.Group,n=new THREE.Mesh(new THREE.BoxBufferGeometry(15*20,15*20,20*20),new THREE.MeshPhongMaterial({color:5056806,flatShading:!0}));n.position.z=10*20,n.castShadow=!0,n.receiveShadow=!0,o.add(n);let t=U[Math.floor(Math.random()*U.length)],a=new THREE.Mesh(new THREE.BoxBufferGeometry(30*20,30*20,t*20),new THREE.MeshLambertMaterial({color:8036893,flatShading:!0}));return a.position.z=(t/2+20)*20,a.castShadow=!0,a.receiveShadow=!1,o.add(a),o}d(j,"Three");function z(){let o=new THREE.Group,t=d(a=>new THREE.Mesh(new THREE.BoxBufferGeometry(u*20,E*20,3*20),new THREE.MeshPhongMaterial({color:a})),"createSection")(12252245);return t.receiveShadow=!0,o.add(t),o.position.z=1.5*20,o}d(z,"Grass");function v(){let o=new THREE.Group,n=d(r=>new THREE.Mesh(new THREE.PlaneBufferGeometry(u*20,E*20),new THREE.MeshPhongMaterial({color:r})),"createSection"),t=n(4541017);t.receiveShadow=!0,o.add(t);let a=n(3751241);a.position.x=-u*20,o.add(a);let i=n(3751241);return i.position.x=u*20,o.add(i),o}d(v,"Road");var D=[10822947,12432952,7909707],ce=new g(40,80,[{x:0,y:10,w:30,h:60}]),he=new g(40,80,[{x:10,y:10,w:30,h:60}]),le=new g(110,40,[{x:10,y:0,w:50,h:30},{x:70,y:0,w:30,h:30}]),de=new g(110,40,[{x:10,y:10,w:50,h:30},{x:70,y:10,w:30,h:30}]),Ee=new g(30,30,[{x:15,y:0,w:10,h:30}]),fe=new g(25,30,[{x:0,y:15,w:10,h:10}]),we=new g(25,30,[{x:0,y:5,w:10,h:10}]);function q(){let o=new THREE.Group,n=D[Math.floor(Math.random()*D.length)],t=new THREE.Mesh(new THREE.BoxBufferGeometry(60*20,30*20,15*20),new THREE.MeshPhongMaterial({color:n,flatShading:!0}));t.position.z=12*20,t.castShadow=!0,t.receiveShadow=!0,o.add(t);let a=new THREE.Mesh(new THREE.BoxBufferGeometry(33*20,24*20,12*20),[new THREE.MeshPhongMaterial({color:13421772,flatShading:!0,map:he}),new THREE.MeshPhongMaterial({color:13421772,flatShading:!0,map:ce}),new THREE.MeshPhongMaterial({color:13421772,flatShading:!0,map:le}),new THREE.MeshPhongMaterial({color:13421772,flatShading:!0,map:de}),new THREE.MeshPhongMaterial({color:13421772,flatShading:!0}),new THREE.MeshPhongMaterial({color:13421772,flatShading:!0})]);a.position.x=6*20,a.position.z=25.5*20,a.castShadow=!0,a.receiveShadow=!0,o.add(a);let i=new b;i.position.x=-18*20,o.add(i);let r=new b;return r.position.x=18*20,o.add(r),o.castShadow=!0,o.receiveShadow=!1,o}d(q,"Car");function V(){let o=new THREE.Group,n=D[Math.floor(Math.random()*D.length)],t=new THREE.Mesh(new THREE.BoxBufferGeometry(100*20,25*20,5*20),new THREE.MeshLambertMaterial({color:11847420,flatShading:!0}));t.position.z=10*20,o.add(t);let a=new THREE.Mesh(new THREE.BoxBufferGeometry(75*20,35*20,40*20),new THREE.MeshPhongMaterial({color:11847420,flatShading:!0}));a.position.x=15*20,a.position.z=30*20,a.castShadow=!0,a.receiveShadow=!0,o.add(a);let i=new THREE.Mesh(new THREE.BoxBufferGeometry(25*20,30*20,30*20),[new THREE.MeshPhongMaterial({color:n,flatShading:!0}),new THREE.MeshPhongMaterial({color:n,flatShading:!0,map:Ee}),new THREE.MeshPhongMaterial({color:n,flatShading:!0,map:fe}),new THREE.MeshPhongMaterial({color:n,flatShading:!0,map:we}),new THREE.MeshPhongMaterial({color:n,flatShading:!0}),new THREE.MeshPhongMaterial({color:n,flatShading:!0})]);i.position.x=-40*20,i.position.z=20*20,i.castShadow=!0,i.receiveShadow=!0,o.add(i);let r=new b;r.position.x=-38*20,o.add(r);let R=new b;R.position.x=-10*20,o.add(R);let I=new b;return I.position.x=30*20,o.add(I),o}d(V,"Truck");function b(){let o=new THREE.Mesh(new THREE.BoxBufferGeometry(12*20,33*20,12*20),new THREE.MeshLambertMaterial({color:3355443,flatShading:!0}));return o.position.z=6*20,o}d(b,"Wheel");function g(o,n,t){let a=document.createElement("canvas");a.width=o,a.height=n;let i=a.getContext("2d");return i.fillStyle="#ffffff",i.fillRect(0,0,o,n),i.fillStyle="rgba(0,0,0,0.6)",t.forEach(r=>{i.fillRect(r.x,r.y,r.w,r.h)}),new THREE.CanvasTexture(a)}d(g,"Texture");var J=d(o=>[-9,-8,-7,-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9].map(n=>{let t=new Te(n);return t.mesh.position.y=n*E*20,o.add(t.mesh),t}).filter(n=>n.index>=0),"generateLanes");function Te(o){switch(this.index=o,this.type=o<=0?"field":G[Math.floor(Math.random()*G.length)],this.type){case"field":{this.type="field",this.mesh=new z;break}case"forest":{this.mesh=new z,this.occupiedPositions=new Set,this.threes=[1,2,3,4].map(()=>{let n=new j,t;do t=Math.floor(Math.random()*m);while(this.occupiedPositions.has(t));return this.occupiedPositions.add(t),n.position.x=(t*E+E/2)*20-u*20/2,this.mesh.add(n),n});break}case"car":{this.mesh=new v,this.direction=Math.random()>=.5;let n=new Set;this.vechicles=[1,2,3].map(()=>{let t=new q,a;do a=Math.floor(Math.random()*m/2);while(n.has(a));return n.add(a),t.position.x=(a*E*2+E/2)*20-u*20/2,this.direction||(t.rotation.z=Math.PI),this.mesh.add(t),t}),this.speed=B[Math.floor(Math.random()*B.length)];break}case"truck":{this.mesh=new v,this.direction=Math.random()>=.5;let n=new Set;this.vechicles=[1,2].map(()=>{let t=new V,a;do a=Math.floor(Math.random()*m/3);while(n.has(a));return n.add(a),t.position.x=(a*E*3+E/2)*20-u*20/2,this.direction||(t.rotation.z=Math.PI),this.mesh.add(t),t}),this.speed=B[Math.floor(Math.random()*B.length)];break}}}d(Te,"Lane");var s=Object.freeze({COW:{BASE:"rgb(255, 255, 255)",BROWN:"rgb(105, 59, 7)",PINK:"rgb(232, 106, 218)",BLACK:"rgb(0, 0, 0)"}}),L=Object.freeze({COW:{RIGHT:new N(70,70,[{x:0,y:20,w:20,h:40,color:s.COW.BROWN},{x:20,y:30,w:10,h:20,color:s.COW.BROWN},{x:30,y:0,w:10,h:10,color:s.COW.PINK}]),LEFT:new N(70,70,[{x:50,y:0,w:20,h:40,color:s.COW.BROWN},{x:40,y:0,w:10,h:30,color:s.COW.BROWN},{x:30,y:10,w:10,h:10,color:s.COW.BROWN},{x:50,y:60,w:20,h:10,color:s.COW.BROWN},{x:10,y:40,w:20,h:10,color:s.COW.BROWN},{x:30,y:0,w:10,h:10,color:s.COW.PINK}]),FRONT:new N(70,70,[{x:30,y:60,w:10,h:10,color:s.COW.BROWN},{x:0,y:40,w:30,h:30,color:s.COW.BROWN},{x:10,y:30,w:10,h:10,color:s.COW.BROWN},{x:10,y:40,w:10,h:10,color:s.COW.BLACK},{x:50,y:40,w:10,h:10,color:s.COW.BLACK},{x:0,y:30,w:10,h:10,color:s.COW.PINK},{x:60,y:30,w:10,h:10,color:s.COW.PINK},{x:20,y:20,w:30,h:20,color:s.COW.PINK}]),BACK:new N(70,70,[{x:0,y:0,w:10,h:20,color:s.COW.BROWN},{x:10,y:0,w:10,h:10,color:s.COW.BROWN},{x:30,y:50,w:10,h:10,color:s.COW.BLACK}]),TOP:new N(70,70,[{x:0,y:0,w:30,h:30,color:s.COW.BROWN},{x:30,y:0,w:10,h:10,color:s.COW.BROWN},{x:0,y:30,w:10,h:10,color:s.COW.BROWN},{x:10,y:10,w:10,h:10,color:s.COW.BLACK},{x:50,y:10,w:10,h:10,color:s.COW.BLACK},{x:0,y:60,w:20,h:10,color:s.COW.BROWN},{x:60,y:20,w:10,h:40,color:s.COW.BROWN},{x:50,y:30,w:10,h:10,color:s.COW.BROWN}])}});function Q(o){switch(o){case"fox":return ue();default:return pe()}}d(Q,"Player");function ue(){let o=new THREE.Group,n=[new THREE.MeshBasicMaterial({side:THREE.DoubleSide,map:L.COW.RIGHT}),new THREE.MeshBasicMaterial({side:THREE.DoubleSide,map:L.COW.LEFT}),new THREE.MeshBasicMaterial({side:THREE.DoubleSide,map:L.COW.FRONT}),new THREE.MeshBasicMaterial({side:THREE.DoubleSide,map:L.COW.BACK}),new THREE.MeshBasicMaterial({side:THREE.DoubleSide,map:L.COW.TOP}),new THREE.MeshBasicMaterial({color:15733283,side:THREE.DoubleSide})],t=new THREE.Mesh(new THREE.BoxGeometry(h*20,h*20,h*20),n);t.position.z=8*20,t.castShadow=!0,t.receiveShadow=!0,o.add(t);let a=new THREE.Mesh(new THREE.BoxBufferGeometry(6*20,3*20,4*20),new THREE.MeshLambertMaterial({color:s.COW.PINK,flatShading:!0}));a.position.z=h/2*20,a.position.y=h/2*20,a.castShadow=!0,a.receiveShadow=!1,o.add(a);let i=new THREE.Mesh(new THREE.BoxBufferGeometry(2*20,2*20,2*20),new THREE.MeshLambertMaterial({color:s.COW.BLACK,flatShading:!0}));i.position.z=(h+1.5)*20,i.position.y=h/3.5*20,i.position.x=h/3.3*20,i.castShadow=!0,i.receiveShadow=!1,o.add(i);let r=new THREE.Mesh(new THREE.BoxBufferGeometry(2*20,2*20,2*20),new THREE.MeshLambertMaterial({color:s.COW.BLACK,flatShading:!0}));r.position.z=(h+1.5)*20,r.position.y=h/3.5*20,r.position.x=-(h/3.3)*20,r.castShadow=!0,r.receiveShadow=!1,o.add(r);let R=new THREE.Mesh(new THREE.BoxBufferGeometry(2*20,2*20,2*20),new THREE.MeshLambertMaterial({color:s.COW.BASE,flatShading:!0}));R.position.z=(h-2)*20,R.position.y=h/3.5*20,R.position.x=-(h/1.8)*20,R.castShadow=!0,R.receiveShadow=!1,o.add(R);let I=new THREE.Mesh(new THREE.BoxBufferGeometry(2*20,2*20,2*20),new THREE.MeshLambertMaterial({color:s.COW.BASE,flatShading:!0}));I.position.z=(h-2)*20,I.position.y=h/3.5*20,I.position.x=h/1.8*20,I.castShadow=!0,I.receiveShadow=!1,o.add(I);let A=new THREE.Mesh(new THREE.BoxBufferGeometry(2*20,2*20,4*20),new THREE.MeshLambertMaterial({color:s.COW.BLACK,flatShading:!0}));return A.position.z=h/3*20,A.position.y=-(h/1.8)*20,A.castShadow=!0,A.receiveShadow=!1,o.add(A),o}d(ue,"cowPlayer");function pe(){let o=new THREE.Group,n=new THREE.Mesh(new THREE.BoxBufferGeometry(h*20,h*20,20*20),new THREE.MeshPhongMaterial({color:16777215,flatShading:!0}));n.position.z=10*20,n.castShadow=!0,n.receiveShadow=!0,o.add(n);let t=new THREE.Mesh(new THREE.BoxBufferGeometry(2*20,4*20,2*20),new THREE.MeshLambertMaterial({color:15753626,flatShading:!0}));return t.position.z=21*20,t.castShadow=!0,t.receiveShadow=!1,o.add(t),o}d(pe,"originalChickenPlayer");function N(o,n,t){let a=document.createElement("canvas");a.width=o,a.height=n;let i=a.getContext("2d");return t.forEach(r=>{i.fillStyle=r.color,i.fillRect(r.x,r.y,r.w,r.h)}),console.log(a),new THREE.CanvasTexture(a)}d(N,"CanvasTexture");var $=document.getElementById("counter"),ee=document.getElementById("end"),y=new THREE.Scene;y.background=Y;var p=new THREE.OrthographicCamera(globalThis.innerWidth/-2,globalThis.innerWidth/2,globalThis.innerHeight/2,globalThis.innerHeight/-2,.1,1e4);p.rotation.x=l.CAMERA.ROTATION.X;p.rotation.y=l.CAMERA.ROTATION.Y;p.rotation.z=l.CAMERA.ROTATION.Z;p.position.y=l.CAMERA.POSITION.Y;p.position.x=l.CAMERA.POSITION.X;p.position.z=500;var T,M,P,O,W,C,S,x,c=new Q("fox");y.add(c);var Re=new THREE.HemisphereLight(16777215,16777215,.6);y.add(Re);var f=new THREE.DirectionalLight(16777215,.6);f.position.set(l.DIR_LIGHT.POSITION.X,l.DIR_LIGHT.POSITION.Y,200);f.castShadow=!0;f.target=c;y.add(f);f.shadow.mapSize.width=2048;f.shadow.mapSize.height=2048;f.shadow.camera.left=l.DIR_LIGHT.SHADOW.CAMERA.LEFT;f.shadow.camera.right=l.DIR_LIGHT.SHADOW.CAMERA.RIGHT;f.shadow.camera.top=l.DIR_LIGHT.SHADOW.CAMERA.TOP;f.shadow.camera.bottom=l.DIR_LIGHT.SHADOW.CAMERA.BOTTON;var X=new THREE.DirectionalLight(0,.4);X.position.set(200,200,50);X.castShadow=!0;y.add(X);var te=d(()=>{T=J(y),M=0,P=Math.floor(m/2),W=null,C=!1,S=[],x="forward",c.position.x=0,c.position.y=0,c.rotation.z=0,p.position.y=l.CAMERA.POSITION.Y,p.position.x=l.CAMERA.POSITION.X,f.position.x=l.DIR_LIGHT.POSITION.X,f.position.y=l.DIR_LIGHT.POSITION.Y},"initaliseValues");te();var k=new THREE.WebGLRenderer({alpha:!0,antialias:!0});k.shadowMap.enabled=!0;k.shadowMap.type=THREE.PCFSoftShadowMap;k.setSize(globalThis.innerWidth,globalThis.innerHeight);document.body.appendChild(k.domElement);function H(o){if(S.length>=2)return;let n=S.reduce((t,a)=>{if(a==="forward")return{lane:t.lane+1,column:t.column};if(a==="backward")return{lane:t.lane-1,column:t.column};if(a==="left")return{lane:t.lane,column:t.column-1};if(a==="right")return{lane:t.lane,column:t.column+1}},{lane:M,column:P});if(o==="forward"){if(T[n.lane+1].type==="forest"&&T[n.lane+1].occupiedPositions.has(n.column))return;O||(C=!0)}else if(o==="backward"){if(n.lane===0||T[n.lane-1].type==="forest"&&T[n.lane-1].occupiedPositions.has(n.column))return;O||(C=!0)}else if(o==="left"){if(n.column===0||T[n.lane].type==="forest"&&T[n.lane].occupiedPositions.has(n.column-1))return;O||(C=!0)}else if(o==="right"){if(n.column===m-1||T[n.lane].type==="forest"&&T[n.lane].occupiedPositions.has(n.column+1))return;O||(C=!0)}S.push(o)}d(H,"move");document.querySelector("#retry").addEventListener("click",()=>{T.forEach(o=>y.remove(o.mesh)),te(),ee.style.visibility="hidden"});document.getElementById("forward").addEventListener("click",()=>H("forward"));document.getElementById("backward").addEventListener("click",()=>H("backward"));document.getElementById("left").addEventListener("click",()=>H("left"));document.getElementById("right").addEventListener("click",()=>H("right"));globalThis.addEventListener("keydown",o=>{o.keyCode=="38"?H("forward"):o.keyCode=="40"?H("backward"):o.keyCode=="37"?H("left"):o.keyCode=="39"&&H("right")});function oe(o){requestAnimationFrame(oe),W||(W=o);let n=o-W;if(W=o,T.forEach(t=>{if(t.type==="car"||t.type==="truck"){let a=-u*20/2-E*2*20,i=u*20/2+E*2*20;t.vechicles.forEach(r=>{t.direction?r.position.x=r.position.x<a?i:r.position.x-=t.speed/16*n:r.position.x=r.position.x>i?a:r.position.x+=t.speed/16*n})}}),C&&(O=o,C=!1),O){let t=o-O,a=Math.min(t/200,1)*E*20,i=Math.sin(Math.min(t/200,1)*Math.PI)*8*20;switch(S[0]){case"forward":{let r=M*E*20+a;switch(p.position.y=l.CAMERA.POSITION.Y+r,f.position.y=l.DIR_LIGHT.POSITION.Y+r,c.position.y=r,c.position.z=i,x){case"left":c.rotation.z=-(Math.min(t/200,1)-1)*Math.PI/2;break;case"right":c.rotation.z=(Math.min(t/200,1)-1)*Math.PI/2;break;case"backward":c.rotation.z=(Math.min(t/200,1)-1)*Math.PI;break;default:break}break}case"backward":{let r=M*E*20-a;switch(p.position.y=l.CAMERA.POSITION.Y+r,f.position.y=l.DIR_LIGHT.POSITION.Y+r,c.position.y=r,c.position.z=i,x){case"forward":c.rotation.z=-(Math.min(t/200,1)*Math.PI);break;case"left":c.rotation.z=Math.min(t/200,1)*Math.PI/2+Math.PI/2;break;case"right":c.rotation.z=-(Math.min(t/200,1)*Math.PI/2+Math.PI/2);break;default:break}break}case"left":{let r=(P*E+E/2)*20-u*20/2-a;switch(p.position.x=l.CAMERA.POSITION.X+r,f.position.x=l.DIR_LIGHT.POSITION.X+r,c.position.x=r,c.position.z=i,x){case"forward":c.rotation.z=Math.min(t/200,1)*Math.PI/2;break;case"backward":c.rotation.z=-(Math.min(t/200,1)*Math.PI/2-Math.PI);break;case"right":c.rotation.z=-(Math.min(t/200,1)*Math.PI+Math.PI/2);break;default:break}break}case"right":{let r=(P*E+E/2)*20-u*20/2+a;switch(p.position.x=l.CAMERA.POSITION.X+r,f.position.x=l.DIR_LIGHT.POSITION.X+r,c.position.x=r,c.position.z=i,x){case"forward":c.rotation.z=-(Math.min(t/200,1)*Math.PI/2);break;case"backward":c.rotation.z=Math.min(t/200,1)*Math.PI/2-Math.PI;break;case"left":c.rotation.z=Math.min(t/200,1)*Math.PI+Math.PI/2;break;default:break}break}}if(t>200){switch(S[0]){case"forward":{M++,$.innerHTML=M,x="forward";break}case"backward":{M--,$.innerHTML=M,x="backward";break}case"left":{P--,x="left";break}case"right":{P++,x="right";break}}S.shift(),O=S.length===0?null:o}}if(T[M].type==="car"||T[M].type==="truck"){let t=c.position.x-h*20/2,a=c.position.x+h*20/2,i={car:60,truck:105}[T[M].type];T[M].vechicles.forEach(r=>{let R=r.position.x-i*20/2,I=r.position.x+i*20/2;a>R&&t<I&&(ee.style.visibility="visible")})}k.render(y,p)}d(oe,"animate");requestAnimationFrame(oe);
