var J=Object.defineProperty;var d=(t,i)=>J(t,"name",{value:i,configurable:!0});var D=new THREE.Color().setHex(8900331),Q=-100,$=-100,N=500,G=50*Math.PI/180,z=20*Math.PI/180,ee=10*Math.PI/180,v=-Math.tan(G)*500,te=Math.tan(z)*Math.sqrt(500**2+v**2),c=Object.freeze({DIR_LIGHT:{POSITION:{X:Q,Y:$},SHADOW:{CAMERA:{LEFT:-N,RIGHT:N,TOP:N,BOTTON:-N}}},CAMERA:{ROTATION:{X:G,Y:z,Z:ee},POSITION:{X:te,Y:v}}}),h=15,E=42,Y=3;var C=E*Y,W=42;function _(){let t=new THREE.Group,o=d(a=>new THREE.Mesh(new THREE.BoxBufferGeometry(W*2,E*2),new THREE.MeshPhongMaterial({color:a})),"createSection")(12252245);return o.receiveShadow=!0,t.add(o),t.position.z=1.5*2,t}d(_,"GrassTile");function K(){let t=new THREE.Group,o=d(a=>new THREE.Mesh(new THREE.BoxBufferGeometry(W*2,E*2),new THREE.MeshPhongMaterial({color:a})),"createSection")(4541017);return o.receiveShadow=!0,t.add(o),t.position.z=1.5*2,t}d(K,"RoadTile");var ue=new O(40,80,[{x:0,y:10,w:30,h:60}]),Me=new O(40,80,[{x:10,y:10,w:30,h:60}]),Re=new O(110,40,[{x:10,y:0,w:50,h:30},{x:70,y:0,w:30,h:30}]),pe=new O(110,40,[{x:10,y:10,w:50,h:30},{x:70,y:10,w:30,h:30}]),Ie=new O(30,30,[{x:15,y:0,w:10,h:30}]),xe=new O(25,30,[{x:0,y:15,w:10,h:10}]),Oe=new O(25,30,[{x:0,y:5,w:10,h:10}]);function O(t,i,o){let a=document.createElement("canvas");a.width=t,a.height=i;let l=a.getContext("2d");return l.fillStyle="#ffffff",l.fillRect(0,0,t,i),l.fillStyle="rgba(0,0,0,0.6)",o.forEach(r=>{l.fillRect(r.x,r.y,r.w,r.h)}),new THREE.CanvasTexture(a)}d(O,"Texture");var X=["grass","road","tree","rock"],m=[[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0]];function Z(t){for(let i=0;i<m.length;i++)for(let o=0;o<m[i].length;o++){let a=new oe(m[i][o],i,o);a.mesh.position.x=i*E*2-E*2,a.mesh.position.y=o*E*2,t.add(a.mesh)}}d(Z,"generateMap");function oe(t,i,o){switch(this.x_index=i,this.y_index=o,this.type=X[t],this.occupiedPositions=new Set,this.type){case"grass":this.mesh=new _;break;case"road":this.mesh=new K;break;default:this.mesh=new _;break}}d(oe,"Tile");var n=Object.freeze({COW:{BASE:"rgb(255, 255, 255)",BROWN:"rgb(105, 59, 7)",PINK:"rgb(232, 106, 218)",BLACK:"rgb(0, 0, 0)"}}),A=Object.freeze({COW:{RIGHT:new b(70,70,[{x:0,y:20,w:20,h:40,color:n.COW.BROWN},{x:20,y:30,w:10,h:20,color:n.COW.BROWN},{x:30,y:0,w:10,h:10,color:n.COW.PINK}]),LEFT:new b(70,70,[{x:50,y:0,w:20,h:40,color:n.COW.BROWN},{x:40,y:0,w:10,h:30,color:n.COW.BROWN},{x:30,y:10,w:10,h:10,color:n.COW.BROWN},{x:50,y:60,w:20,h:10,color:n.COW.BROWN},{x:10,y:40,w:20,h:10,color:n.COW.BROWN},{x:30,y:0,w:10,h:10,color:n.COW.PINK}]),FRONT:new b(70,70,[{x:30,y:60,w:10,h:10,color:n.COW.BROWN},{x:0,y:40,w:30,h:30,color:n.COW.BROWN},{x:10,y:30,w:10,h:10,color:n.COW.BROWN},{x:10,y:40,w:10,h:10,color:n.COW.BLACK},{x:50,y:40,w:10,h:10,color:n.COW.BLACK},{x:0,y:30,w:10,h:10,color:n.COW.PINK},{x:60,y:30,w:10,h:10,color:n.COW.PINK},{x:20,y:20,w:30,h:20,color:n.COW.PINK}]),BACK:new b(70,70,[{x:0,y:0,w:10,h:20,color:n.COW.BROWN},{x:10,y:0,w:10,h:10,color:n.COW.BROWN},{x:30,y:50,w:10,h:10,color:n.COW.BLACK}]),TOP:new b(70,70,[{x:0,y:0,w:30,h:30,color:n.COW.BROWN},{x:30,y:0,w:10,h:10,color:n.COW.BROWN},{x:0,y:30,w:10,h:10,color:n.COW.BROWN},{x:10,y:10,w:10,h:10,color:n.COW.BLACK},{x:50,y:10,w:10,h:10,color:n.COW.BLACK},{x:0,y:60,w:20,h:10,color:n.COW.BROWN},{x:60,y:20,w:10,h:40,color:n.COW.BROWN},{x:50,y:30,w:10,h:10,color:n.COW.BROWN}])}});function F(t){switch(t){case"cow":return ne();default:return ae()}}d(F,"Player");function ne(){let t=new THREE.Group,i=[new THREE.MeshBasicMaterial({side:THREE.DoubleSide,map:A.COW.RIGHT}),new THREE.MeshBasicMaterial({side:THREE.DoubleSide,map:A.COW.LEFT}),new THREE.MeshBasicMaterial({side:THREE.DoubleSide,map:A.COW.FRONT}),new THREE.MeshBasicMaterial({side:THREE.DoubleSide,map:A.COW.BACK}),new THREE.MeshBasicMaterial({side:THREE.DoubleSide,map:A.COW.TOP}),new THREE.MeshBasicMaterial({color:15733283,side:THREE.DoubleSide})],o=new THREE.Mesh(new THREE.BoxGeometry(h*2,h*2,h*2),i);o.position.z=8*2,o.castShadow=!0,o.receiveShadow=!0,t.add(o);let a=new THREE.Mesh(new THREE.BoxBufferGeometry(6*2,3*2,4*2),new THREE.MeshLambertMaterial({color:n.COW.PINK,flatShading:!0}));a.position.z=h/2*2,a.position.y=h/2*2,a.castShadow=!0,a.receiveShadow=!1,t.add(a);let l=new THREE.Mesh(new THREE.BoxBufferGeometry(2*2,2*2,2*2),new THREE.MeshLambertMaterial({color:n.COW.BLACK,flatShading:!0}));l.position.z=(h+1.5)*2,l.position.y=h/3.5*2,l.position.x=h/3.3*2,l.castShadow=!0,l.receiveShadow=!1,t.add(l);let r=new THREE.Mesh(new THREE.BoxBufferGeometry(2*2,2*2,2*2),new THREE.MeshLambertMaterial({color:n.COW.BLACK,flatShading:!0}));r.position.z=(h+1.5)*2,r.position.y=h/3.5*2,r.position.x=-(h/3.3)*2,r.castShadow=!0,r.receiveShadow=!1,t.add(r);let H=new THREE.Mesh(new THREE.BoxBufferGeometry(2*2,2*2,2*2),new THREE.MeshLambertMaterial({color:n.COW.BASE,flatShading:!0}));H.position.z=(h-2)*2,H.position.y=h/3.5*2,H.position.x=-(h/1.8)*2,H.castShadow=!0,H.receiveShadow=!1,t.add(H);let g=new THREE.Mesh(new THREE.BoxBufferGeometry(2*2,2*2,2*2),new THREE.MeshLambertMaterial({color:n.COW.BASE,flatShading:!0}));g.position.z=(h-2)*2,g.position.y=h/3.5*2,g.position.x=h/1.8*2,g.castShadow=!0,g.receiveShadow=!1,t.add(g);let P=new THREE.Mesh(new THREE.BoxBufferGeometry(2*2,2*2,4*2),new THREE.MeshLambertMaterial({color:n.COW.BLACK,flatShading:!0}));return P.position.z=h/3*2,P.position.y=-(h/1.8)*2,P.castShadow=!0,P.receiveShadow=!1,t.add(P),t}d(ne,"cowPlayer");function ae(){let t=new THREE.Group,i=new THREE.Mesh(new THREE.BoxBufferGeometry(h*2,h*2,20*2),new THREE.MeshPhongMaterial({color:16777215,flatShading:!0}));i.position.z=10*2,i.castShadow=!0,i.receiveShadow=!0,t.add(i);let o=new THREE.Mesh(new THREE.BoxBufferGeometry(2*2,4*2,2*2),new THREE.MeshLambertMaterial({color:15753626,flatShading:!0}));return o.position.z=21*2,o.castShadow=!0,o.receiveShadow=!1,t.add(o),t}d(ae,"originalChickenPlayer");function b(t,i,o){let a=document.createElement("canvas");a.width=t,a.height=i;let l=a.getContext("2d");return o.forEach(r=>{l.fillStyle=r.color,l.fillRect(r.x,r.y,r.w,r.h)}),new THREE.CanvasTexture(a)}d(b,"CanvasTexture");var U=document.getElementById("counter"),ie=document.getElementById("end"),se=m[0].length,ce=m.length,x=new THREE.Scene;x.background=D;var f=new THREE.OrthographicCamera(globalThis.innerWidth/-2,globalThis.innerWidth/2,globalThis.innerHeight/2,globalThis.innerHeight/-2,.1,1e4);f.rotation.x=c.CAMERA.ROTATION.X;f.rotation.y=c.CAMERA.ROTATION.Y;f.rotation.z=c.CAMERA.ROTATION.Z;f.position.y=c.CAMERA.POSITION.Y;f.position.x=c.CAMERA.POSITION.X;f.position.z=500;var j,R,y,M,B,S,p,u,s=new F("cow");x.add(s);var he=new THREE.HemisphereLight(16777215,16777215,.6);x.add(he);var w=new THREE.DirectionalLight(16777215,.6);w.position.set(c.DIR_LIGHT.POSITION.X,c.DIR_LIGHT.POSITION.Y,200);w.castShadow=!0;w.target=s;x.add(w);w.shadow.mapSize.width=2048;w.shadow.mapSize.height=2048;w.shadow.camera.left=c.DIR_LIGHT.SHADOW.CAMERA.LEFT;w.shadow.camera.right=c.DIR_LIGHT.SHADOW.CAMERA.RIGHT;w.shadow.camera.top=c.DIR_LIGHT.SHADOW.CAMERA.TOP;w.shadow.camera.bottom=c.DIR_LIGHT.SHADOW.CAMERA.BOTTON;var k=new THREE.DirectionalLight(0,.4);k.position.set(200,200,50);k.castShadow=!0;x.add(k);var q=d(()=>{j=Z(x),R=0,y=1,B=null,S=!1,p=[],u="forward",s.position.x=0,s.position.y=0,s.rotation.z=0,f.position.y=c.CAMERA.POSITION.Y,f.position.x=c.CAMERA.POSITION.X,w.position.x=c.DIR_LIGHT.POSITION.X,w.position.y=c.DIR_LIGHT.POSITION.Y},"initaliseValues");q();var L=new THREE.WebGLRenderer({alpha:!0,antialias:!0});L.shadowMap.enabled=!0;L.shadowMap.type=THREE.PCFSoftShadowMap;L.setSize(globalThis.innerWidth,globalThis.innerHeight);document.body.appendChild(L.domElement);function I(t){if(p.length>=2)return;let i=p.reduce((o,a)=>{if(a==="forward")return{lane:o.lane+1,column:o.column};if(a==="backward")return{lane:o.lane-1,column:o.column};if(a==="left")return{lane:o.lane,column:o.column-1};if(a==="right")return{lane:o.lane,column:o.column+1}},{lane:R,column:y});if(t==="forward"){if(i.lane===se-1)return;M||(S=!0)}else if(t==="backward"){if(i.lane===0)return;M||(S=!0)}else if(t==="left"){if(i.column===0)return;M||(S=!0)}else if(t==="right"){if(i.column===ce-1)return;M||(S=!0)}p.push(t)}d(I,"move");document.querySelector("#retry").addEventListener("click",()=>{j.forEach(t=>x.remove(t.mesh)),q(),ie.style.visibility="hidden"});document.getElementById("forward").addEventListener("click",()=>I("forward"));document.getElementById("backward").addEventListener("click",()=>I("backward"));document.getElementById("left").addEventListener("click",()=>I("left"));document.getElementById("right").addEventListener("click",()=>I("right"));globalThis.addEventListener("keydown",t=>{t.keyCode=="38"?I("forward"):t.keyCode=="40"?I("backward"):t.keyCode=="37"?I("left"):t.keyCode=="39"&&I("right")});function V(t){requestAnimationFrame(V),B||(B=t);let i=t-B;if(B=t,S&&(M=t,S=!1),M){let o=t-M,a=Math.min(o/200,1)*E*2,l=Math.sin(Math.min(o/200,1)*Math.PI)*8*2;switch(p[0]){case"forward":{let r=R*E*2+a;switch(f.position.y=c.CAMERA.POSITION.Y+r,w.position.y=c.DIR_LIGHT.POSITION.Y+r,s.position.y=r,s.position.z=l,u){case"left":s.rotation.z=-(Math.min(o/200,1)-1)*Math.PI/2;break;case"right":s.rotation.z=(Math.min(o/200,1)-1)*Math.PI/2;break;case"backward":s.rotation.z=(Math.min(o/200,1)-1)*Math.PI;break;default:break}break}case"backward":{let r=R*E*2-a;switch(f.position.y=c.CAMERA.POSITION.Y+r,w.position.y=c.DIR_LIGHT.POSITION.Y+r,s.position.y=r,s.position.z=l,u){case"forward":s.rotation.z=-(Math.min(o/200,1)*Math.PI);break;case"left":s.rotation.z=Math.min(o/200,1)*Math.PI/2+Math.PI/2;break;case"right":s.rotation.z=-(Math.min(o/200,1)*Math.PI/2+Math.PI/2);break;default:break}break}case"left":{let r=(y*E+E/2)*2-C*2/2-a;switch(f.position.x=c.CAMERA.POSITION.X+r,w.position.x=c.DIR_LIGHT.POSITION.X+r,s.position.x=r,s.position.z=l,u){case"forward":s.rotation.z=Math.min(o/200,1)*Math.PI/2;break;case"backward":s.rotation.z=-(Math.min(o/200,1)*Math.PI/2-Math.PI);break;case"right":s.rotation.z=-(Math.min(o/200,1)*Math.PI+Math.PI/2);break;default:break}break}case"right":{let r=(y*E+E/2)*2-C*2/2+a;switch(f.position.x=c.CAMERA.POSITION.X+r,w.position.x=c.DIR_LIGHT.POSITION.X+r,s.position.x=r,s.position.z=l,u){case"forward":s.rotation.z=-(Math.min(o/200,1)*Math.PI/2);break;case"backward":s.rotation.z=Math.min(o/200,1)*Math.PI/2-Math.PI;break;case"left":s.rotation.z=Math.min(o/200,1)*Math.PI+Math.PI/2;break;default:break}break}}if(o>200){switch(p[0]){case"forward":{R++,U.innerHTML=R,u="forward";break}case"backward":{R--,U.innerHTML=R,u="backward";break}case"left":{y--,u="left";break}case"right":{y++,u="right";break}}p.shift(),M=p.length===0?null:t}}L.render(x,f)}d(V,"animate");requestAnimationFrame(V);
